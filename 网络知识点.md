# 网络知识点


### 运输层
运输层向它上面的应用层提供通信服务。网络层为主机之间提供逻辑通信，而运输层为应用进程之间提供端到端的逻辑通信。


### 用户数据报协议UDP
用户数据报协议UDP只在IP的数据报服务之上增加了很少一点的功能，这就是复用和分用的功能以及差错检测的功能。
#### 主要特点：
+ UDP 是无连接的。
即发送数据之前不需要建立连接，因此减少了开销和发送数据之前的时延。
+ UDP 使用尽最大努力交付。
因此不保证可靠交付，主机不需要维持复杂的连接状态表。
+ UDP 是面向报文的。
发送方的 UDP 对应用程序交付下来的报文，在添加首部后就向下交付给 IP 层。应用层交给 UDP 多长的报文，UDP 就照样发送多长的报文。接受方的 UDP 对 IP 层交上来的 UDP 数据报，再去除首部后就原封不动的交付给上层的应用进程。因此，UDP 一次交付一个完整的报文。
+ UDP 没有拥塞控制。
因此网络出现的拥塞不会使源主机的发送速率降低。很多实时应用（IP 电话。实时视频等）要求源主机以恒定的速率发送数据，并且允许在网络发生拥塞时丢失一些数据，但却不允许有太大的时延。UDP 的特点正好满足这些要求。
+ UDP 支持一对一、一对多、多对一、多对多的交互通信。
+ UDP 的头部信息开销很小，只有 8 个字节，比 TCP 的 20 个字节要小很多。


### 传输控制协议TCP
#### 主要特点：
+ TCP协议是面向连接的运输层协议
在数据传输前必须建立连接，数据传输之后释放连接。
+ TCP提供可靠交付的服务
所谓可靠是指在传输过程中无重复，无丢失，无错误。但是同时会增加开销。
+ 每一条连接都是点对点连接
+ 面向字节流
所谓字节流指的是以传输过程中流入进程和流出进程的字节序列，虽然传输过程中是一个一个数据报，但这只是为了方便传输，之后在目的端重新装配。
+ TCP提供全双工通信
所谓全双工是指一端既可以是客户端，也可以是服务器。

#### 套接字
套接字 socket = (ip 地址 ： 端口)
每一条TCP连接唯一地被通信两端的两个端点（即两个套接字）所确定

### TCP的拥塞控制
#### TCP的四种拥塞控制算法
慢开始  由小到大逐渐增大发送窗口 加倍
拥塞避免  按线性规律缓慢增长
快重传  让发送方尽早知道发生了个别报文段的丢失 如：三个重复确认M2，立即进行重传M3
快恢复  丢失个别的报文段，快恢复。如：窗口减半，然后执行拥塞避免算法

### TCP的运输连接管理
#### TCP的连接建立 三次握手
客户端请求
服务器确认
客户端确认 此次确认是为了防止已失效的连接请求报文突然又传送到了服务器，若没有第三次握手，那么服务器会认为连接已建立，会一直等待客户端发来数据，从而造成资源的浪费


#### TCP的连接释放 四次握手
客户端请求释放
服务器确认 TCP半关闭状态 服务器还能发送数据
服务器重复上次的确认号
客户端确认 服务器接收后关闭，客户端等待2MSL后关闭

##### 时间MSL叫做最长报文段寿命


------------


### 超文本传送协议HTTP
HTTP协议定义了浏览器（万维网客户进程）怎样向万维网服务器请求万维网文档，以及服务器怎样把文档传送给浏览器。从层次的角度看，HTTP是面向事务的（Transaction-oriented）应用层协议，它规定了在浏览器和服务器之间的请求和响应的格式和规则，它是万维网上能够可靠交换文件（包括文本、声音、图像等各种多媒体文件）的重要基础。


#### 输入一个URL后发生了什么
当用户点击鼠标后所发生的时间顺序如下（以访问清华大学为例）：

1. 浏览器分析链接指向页面的URL（http://www.tsinghua.edu.cn/publish/thu2018/index.html）；
2. 浏览器向DNS请求解析www.tsinghua.edu.cn的IP地址；
3. 域名系统DNS解析出清华大学服务器的IP地址；
4. 浏览器与该服务器建立TCP连接（默认端口号80）；
5. 浏览器发出HTTP请求：GET /publish/thu2018/index.html
6. 服务器通过HTTP响应把文件 index.html 发送给浏览器；
7. TCP连接释放；
8. 浏览器将文件 index.html 进行解释，并将Web页显示给用户；


### HTTP状态码
#### 状态码系列
1XX：通知 仅在与HTTP服务器沟通时使用
2XX：成功 表明操作成功了
3XX：重定向 客户端需要做些额外工作才能得到所需要的资源。它们通常用于GET请求。他们通常告诉客户端需要向另一个URI发送GET请求，才能得到所需的表示。那个URI就包含在Location响应报头里。
4XX：客户端错误   这些响应代码表明客户端出现错误。不是认证信息有问题，就是表示格式或HTTP库本身有问题。客户端需要自行改正。
5XX：服务端错误   这些响应代码表明服务器端出现错误。一般来说，这些代码意味着服务器处于不能执行客户端请求的状态，此时客户端应稍后重试。有时，服务器能够估计客户端应在多久之后重试。并把该信息放在Retry-After响应报头里。

#### 各类别常见状态码
+ 2xx （3种）

200 OK：表示从客户端发送给服务器的请求被正常处理并返回；

204 No Content：表示客户端发送给客户端的请求得到了成功处理，但在返回的响应报文中不含实体的主体部分（没有资源可以返回）；

206 Patial Content：表示客户端进行了范围请求，并且服务器成功执行了这部分的GET请求，响应报文中包含由Content-Range指定范围的实体内容。

+ 3xx （5种）

301 Moved Permanently：永久性重定向，表示请求的资源被分配了新的URL，之后应使用更改的URL；

302 Found：临时性重定向，表示请求的资源被分配了新的URL，希望本次访问使用新的URL；
301与302的区别：前者是永久移动，后者是临时移动（之后可能还会更改URL）

303 See Other：表示请求的资源被分配了新的URL，应使用GET方法定向获取请求的资源；
302与303的区别：后者明确表示客户端应当采用GET方式获取资源

304 Not Modified：表示客户端发送附带条件（是指采用GET方法的请求报文中包含if-Match、If-Modified-Since、If-None-Match、If-Range、If-Unmodified-Since中任一首部）的请求时，服务器端允许访问资源，但是请求为满足条件的情况下返回改状态码；

307 Temporary Redirect：临时重定向，与303有着相同的含义，307会遵照浏览器标准不会从POST变成GET；（不同浏览器可能会出现不同的情况）；

+ 4xx （4种）

400 Bad Request：表示请求报文中存在语法错误；

401 Unauthorized：未经许可，需要通过HTTP认证；

403 Forbidden：服务器拒绝该次访问（访问权限出现问题）

404 Not Found：表示服务器上无法找到请求的资源，除此之外，也可以在服务器拒绝请求但不想给拒绝原因时使用；

+ 5xx （2种）

500 Inter Server Error：表示服务器在执行请求时发生了错误，也有可能是web应用存在的bug或某些临时的错误时；

503 Server Unavailable：表示服务器暂时处于超负载或正在进行停机维护，无法处理请求；

 

### GET和POST两种基本请求方法的区别
GET和POST是什么？HTTP协议中的两种发送请求的方法。
最直观的区别就是GET把参数包含在URL中，POST通过request body传递参数。

#### 关于安全性
我们常听到GET不如POST安全，因为POST用body传输数据，而GET用url传输，更加容易看到。但是从攻击的角度，无论是GET还是POST都不够安全，因为HTTP本身是明文协议。每个HTTP请求和返回的每个byte都会在网络上明文传播，不管是url，header还是body。这完全不是一个“是否容易在浏览器地址栏上看到“的问题。
为了避免传输中数据被窃取，必须做从客户端到服务器的端端加密。业界的通行做法就是https——即用SSL协议协商出的密钥加密明文的http数据。这个加密的协议和HTTP协议本身相互独立。如果是利用HTTP开发公网的站点/App，要保证安全，https是最最基本的要求。

#### 关于编码
常见的说法有，比如GET的参数只能支持ASCII，而POST能支持任意binary，包括中文。但其实从上面可以看到，GET和POST实际上都能用url和body。因此所谓编码确切地说应该是http中url用什么编码，body用什么编码。

#### 关于URL的长度
常说的“GET数据有长度限制“其实是指”URL的长度限制“。
HTTP协议本身对URL长度并没有做任何规定。实际的限制是由客户端/浏览器以及服务器端决定的。


### HTTPS协议
HTTPS协议是由SSL/TLS+HTTP协议构建的可进行加密传输、身份认证的网络协议，要比http协议安全
HTTPS协议的主要作用可以分为两种：一种是建立一个信息安全通道，来保证数据传输的安全；另一种就是确认网站的真实性。

#### 客户端在使用HTTPS方式与Web服务器通信时的步骤
1. 客户使用https的URL访问Web服务器，要求与Web服务器建立SSL连接。
2. Web服务器收到客户端请求后，会将网站的证书信息（证书中包含公钥）传送一份给客户端。
3. 客户端的浏览器与Web服务器开始协商SSL/TLS连接的安全等级，也就是信息加密的等级。
4. 客户端的浏览器根据双方同意的安全等级，建立会话密钥，然后利用网站的公钥将会话密钥加密，并传送给网站。
5. Web服务器利用自己的私钥解密出会话密钥。
6. Web服务器利用会话密钥加密与客户端之间的通信。

### HTTPS和HTTP的主要区别
1. https协议需要到CA申请证书，一般免费证书较少，因而需要一定费用。
2. http是超文本传输协议，信息是明文传输，https则是具有安全性的ssl/tls加密传输协议。
3. http和https使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443。
4. http的连接很简单，是无状态的；HTTPS协议是由SSL/TLS+HTTP协议构建的可进行加密传输、身份认证的网络协议，比http协议安全。

#### SSL与TLS的区别？
+ SSL：（Secure Socket Layer，安全套接字层），位于可靠的面向连接的网络层协议和应用层协议之间的一种协议层。SSL通过互相认证、使用数字签名确保完整性、使用加密确保私密性，以实现客户端和服务器之间的安全通讯。该协议由两层组成：SSL记录协议和SSL握手协议。
+ TLS：(Transport Layer Security，传输层安全协议)，用于两个应用程序之间提供保密性和数据完整性。该协议由两层组成：TLS记录协议和TLS握手协议。


### 域名系统 DNS
DNS是应用层协议，事实上他是为其他应用层协议工作的，包括不限于HTTP和SMTP以及FTP，用于将用户提供的主机名解析为ip地址。
+ 主机向本地域名服务器的查询一般都是采用递归查询。
+ 本地域名服务器向根域名服务器的查询的迭代查询。
